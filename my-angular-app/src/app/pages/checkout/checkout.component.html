<div class="max-w-5xl mx-auto p-4 grid grid-cols-1 md:grid-cols-3 gap-6">

  <!-- LEFT SECTION -->
  <div class="md:col-span-2 space-y-6">

    <!-- ADDRESS SELECTION -->
    <div class="border rounded p-4">
      <h2 class="text-xl font-bold mb-3">Delivery Address</h2>

      <div *ngFor="let a of addresses" class="flex items-start gap-3 mb-3">
        <input
          type="radio"
          name="address"
          [value]="a.id"
          [(ngModel)]="selectedAddressId"
          class="mt-1"
        />

        <div>
          <div class="font-semibold">{{ a.fullName }}</div>
          <div>{{ a.line1 }} {{ a.line2 }}</div>
          <div>{{ a.city }}, {{ a.state }} - {{ a.postalCode }}</div>
          <div class="text-gray-600 text-sm">ðŸ“ž {{ a.phone }}</div>
        </div>
      </div>

      <button 
        class="bg-blue-600 text-white px-4 py-1 rounded mt-2"
        (click)="showAddressForm = !showAddressForm">
        + Add New Address
      </button>

      <!-- NEW ADDRESS FORM -->
      <div *ngIf="showAddressForm" class="mt-4 space-y-2 border p-3 rounded bg-gray-50">
        <input [(ngModel)]="newAddress.fullName" class="input" placeholder="Full Name" />
        <input [(ngModel)]="newAddress.phone" class="input" placeholder="Phone" />
        <input [(ngModel)]="newAddress.line1" class="input" placeholder="Address Line 1" />
        <input [(ngModel)]="newAddress.line2" class="input" placeholder="Address Line 2" />

        <div class="grid grid-cols-3 gap-2">
          <input [(ngModel)]="newAddress.city" class="input" placeholder="City" />
          <input [(ngModel)]="newAddress.state" class="input" placeholder="State" />
          <input [(ngModel)]="newAddress.postalCode" class="input" placeholder="Pincode" />
        </div>

        <input [(ngModel)]="newAddress.country" class="input" placeholder="Country" />

        <button class="bg-green-600 text-white px-4 py-1 rounded" (click)="saveNewAddress()">
          Save Address
        </button>
      </div>
    </div>

    <!-- PAYMENT -->
    <div class="border rounded p-4">
      <h2 class="text-xl font-bold mb-3">Payment Method</h2>

      <label class="flex items-center gap-2">
        <input type="radio" [(ngModel)]="paymentMethod" value="COD" />
        <span>Cash on Delivery (COD)</span>
      </label>

      <label class="flex items-center gap-2 mt-2 opacity-50 cursor-not-allowed">
        <input type="radio" disabled />
        <span>Razorpay (Coming Soon)</span>
      </label>
    </div>

  </div>

  <!-- RIGHT SUMMARY -->
  <div class="border rounded p-4 space-y-3">
    <h2 class="text-xl font-bold mb-2">Order Summary</h2>

    <div class="flex justify-between">
      <span>Items Total</span>
      <span>â‚¹{{ itemsTotal }}</span>
    </div>

    <div class="flex justify-between">
      <span>Tax (5%)</span>
      <span>â‚¹{{ tax }}</span>
    </div>

    <div class="flex justify-between">
      <span>Shipping Fee</span>
      <span>â‚¹{{ shippingFee }}</span>
    </div>

    <hr />

    <div class="flex justify-between font-bold text-lg">
      <span>Grand Total</span>
      <span>â‚¹{{ grandTotal }}</span>
    </div>

    <button
      class="w-full bg-amber-600 text-white py-2 rounded text-lg mt-3"
      [disabled]="loading"
      (click)="placeOrder()">
      {{ loading ? 'Placing Order...' : 'Place Order' }}
    </button>
  </div>
</div>
